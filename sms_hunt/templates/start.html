{% extends "layout.html" %}
{% block title %} - Welcome{% endblock %}
{% block content %}
<div class="starter-template">
    <h1>Pick your side!</h1>

    <p class="lead">Receive goal alerts and match stats for all England, Wales and Northern Ireland Matches!<br>
        Compatible with any phone.</p>

    <div class="details row">
        <div class="col-md-5">
        </div>

        <div class="col-md-2">
        <form class="form-horizontal" role="form" action="/verify" method="post">

            <div class="team row">
                <div class="col-md-12 input-group">
                    <select class="form-control" name="team" id="team_id">
                        {% for name in teams %}
                        <option {% if name==team.value %}selected{% endif %}>{{ name }}</option>
                        {% endfor %}
                    </select>
                </div>
            </div>

            <div class="space row">
                <div class="col-md-12 input-group">
                    &nbsp;
                </div>
            </div>

            <div class="phone_number row">
                {% if phone_number.valid==True %}
                <div class="form-group">
                {% elif phone_number.valid==False %}
                <div class="form-group has-error">
                {% endif %}
                    <div class="col-md-12 input-group">
                        <input type="tel" class="form-control" id="phone_number_id"
                               name="phone_number" placeholder="mobile number"
                               value="{{ phone_number.value }}">
                    </div>
                </div>
            </div>

            <div class="email row">
                {% if email.valid==True %}
                <div class="form-group">
                {% elif email.valid==False %}
                <div class="form-group has-error">
                {% endif %}
                    <div class="col-md-12 input-group">
                        <input type="email" class="form-control" id="email_id"
                               name="email" placeholder="email"
                               value="{{ email.value }}">
                    </div>
                </div>
            </div>

            <div class="button row">
	            <div class="form-group">
                    <div class="col-md-12">
	                    <button type="submit" class="btn btn-success btn-block">Verify
                            </button>
                    </div>
                </div>
	        </div>

            <div class="button_stripe row">
                <div class="form-group stripe_button row">
                    <div class="col-md-12">

                        <script src="https://checkout.stripe.com/checkout.js"></script>

                        <input type="hidden" name="stripeToken" id="stripeToken"/>
                        <input type="hidden" name="stripeEmail" id="stripeEmail"/>

                        <button id="CustomStripeButton" class="btn btn-success btn-block">
                            Pay {{ payment.currency_html|safe }}{{ payment.amount }}
                        </button>

                        <script>
	                var handler = StripeCheckout.configure({
	                    key: '{{ key }}',
	                    token: function(token, args) {
	                        document.getElementById("stripeToken").value = token.id;
                            document.getElementById("stripeEmail").value = token.email;
                            document.getElementById("chargeForm").submit();
	                        // Use the token to create the charge with a server-side script.
	                        // You can access the token ID with `token.id`
	                    }
	                });

                    document.getElementById('CustomStripeButton').addEventListener('click', function(e) {
	                    // Open Checkout with further options
	                    handler.open({
	                        name: '{{ company }}',
	                        description: 'Please enter your details',
	                        amount: {{ payment.amount_pence }},
	                        currency: '{{ payment.currency }}',
	                        billingAddress: true
	                    });
	                    e.preventDefault();
	                });
	                </script>

                    </div>
                </div>
            </div>


        </form>
        </div>

        <div class="col-md-5">
        </div>
    </div>

</div>
{% endblock %}